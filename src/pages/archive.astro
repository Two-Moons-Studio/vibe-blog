---
import Layout from '../layouts/Layout.astro';
import PostPreview from '../components/PostPreview.astro';
import { getCollection } from 'astro:content';

// Get all posts, sorted by date (newest first)
const allPosts = await getCollection('posts');
const sortedPosts = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Layout 
  title="Archive - Vibe Blog" 
  description="All posts from Zero to Vibe Coder - the complete journey from designer to AI builder"
>
  <div class="container">
    <header class="page-header">
      <h1>Archive</h1>
      <p>Every post from the journey so far</p>
    </header>

    <section class="posts">
      {sortedPosts.length > 0 ? (
        sortedPosts.map((post) => (
          <PostPreview
            title={post.data.title}
            date={post.data.date}
            excerpt={post.data.excerpt}
            slug={post.slug}
            tags={post.data.tags}
          />
        ))
      ) : (
        <div class="no-posts">
          <p>No posts yet. Check back soon!</p>
        </div>
      )}
    </section>
  </div>
</Layout>

<style>
  .page-header {
    text-align: center;
    padding: var(--space-8) 0;
    border-bottom: 1px solid var(--color-neutral-20);
    margin-bottom: var(--space-8);
  }

  .page-header h1 {
    margin-bottom: var(--space-3);
  }

  .page-header p {
    font-size: var(--font-size-large);
    color: var(--color-text-secondary);
    margin: 0;
  }

  .posts {
    margin-bottom: var(--space-8);
  }

  .no-posts {
    text-align: center;
    padding: var(--space-8);
    color: var(--color-text-secondary);
  }
</style>